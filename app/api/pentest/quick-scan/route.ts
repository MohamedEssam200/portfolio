import { type NextRequest, NextResponse } from "next/server"

export async function POST(request: NextRequest) {
  try {
    const { target, scanType } = await request.json()

    // Mock quick scan results based on scan type
    let results = {}

    switch (scanType) {
      case "port":
        results = {
          scan_type: "Port Scan",
          target: target,
          open_ports: [22, 80, 443, 8080],
          closed_ports: [21, 23, 25, 53, 110, 143, 993, 995],
          filtered_ports: [135, 139, 445],
        }
        break
      case "service":
        results = {
          scan_type: "Service Detection",
          target: target,
          services: [
            { port: 22, service: "SSH", version: "OpenSSH 7.4" },
            { port: 80, service: "HTTP", version: "Apache 2.4.41" },
            { port: 443, service: "HTTPS", version: "Apache 2.4.41" },
          ],
        }
        break
      case "vuln":
        results = {
          scan_type: "Vulnerability Scan",
          target: target,
          vulnerabilities: [
            {
              type: "CVE-2021-44228",
              severity: "Critical",
              description: "Log4j Remote Code Execution",
            },
            {
              type: "CVE-2021-34527",
              severity: "High",
              description: "Windows Print Spooler Elevation of Privilege",
            },
          ],
        }
        break
      default:
        results = {
          scan_type: "Basic Scan",
          target: target,
          status: "Host is up",
          response_time: "12ms",
        }
    }

    return NextResponse.json({
      success: true,
      results: results,
      timestamp: new Date().toISOString(),
    })
  } catch (error) {
    return NextResponse.json({ success: false, error: "Quick scan failed" }, { status: 500 })
  }
}
